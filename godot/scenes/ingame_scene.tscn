[gd_scene load_steps=13 format=3 uid="uid://cik30de5gaaah"]

[ext_resource type="Script" uid="uid://ovjegpk30m4h" path="res://scenes/ingame_scene.gd" id="1_objyc"]
[ext_resource type="PackedScene" uid="uid://bkk87o2ooo6at" path="res://ui/overlays/fade_overlay.tscn" id="1_y6ebv"]
[ext_resource type="Texture2D" uid="uid://cq6lxyd0vvd2e" path="res://art/panorama_image.png" id="2_gadrd"]
[ext_resource type="Material" uid="uid://cijiuxm0q70tw" path="res://art/planet_mat.tres" id="3_5jhce"]
[ext_resource type="PackedScene" uid="uid://jyv4g54adkmo" path="res://ui/overlays/pause_overlay.tscn" id="3_8o178"]
[ext_resource type="Script" uid="uid://ce6yf2m8pio31" path="res://scenes/game_manager.gd" id="5_2577t"]
[ext_resource type="PackedScene" uid="uid://bemaa4slumja3" path="res://scenes/prefabs/player.tscn" id="7_vus8m"]

[sub_resource type="PanoramaSkyMaterial" id="PanoramaSkyMaterial_5jhce"]
panorama = ExtResource("2_gadrd")

[sub_resource type="Sky" id="Sky_vus8m"]
sky_material = SubResource("PanoramaSkyMaterial_5jhce")

[sub_resource type="Environment" id="Environment_5jhce"]
background_mode = 2
sky = SubResource("Sky_vus8m")
tonemap_mode = 2
glow_enabled = true

[sub_resource type="SphereMesh" id="SphereMesh_gadrd"]

[sub_resource type="Theme" id="Theme_2577t"]

[node name="IngameScene" type="Node3D"]
script = ExtResource("1_objyc")

[node name="StaticEnvironment" type="Node3D" parent="."]

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="StaticEnvironment"]
transform = Transform3D(-0.866024, -0.433016, 0.250001, 0, 0.499998, 0.866026, -0.500003, 0.749999, -0.43301, 0, 0, 0)
shadow_enabled = true

[node name="FillLight" type="DirectionalLight3D" parent="StaticEnvironment"]
transform = Transform3D(-0.211356, -0.273474, -0.938371, 0.887046, 0.349506, -0.301654, 0.410461, -0.896135, 0.168714, 0, 0, 0)
light_color = Color(1, 1, 0.501961, 1)
light_energy = 0.2
light_indirect_energy = 0.2
light_volumetric_fog_energy = 0.2

[node name="WorldEnvironment" type="WorldEnvironment" parent="StaticEnvironment"]
environment = SubResource("Environment_5jhce")

[node name="Planet" type="Node3D" parent="StaticEnvironment"]
unique_name_in_owner = true
transform = Transform3D(10, 0, 0, 0, 10, 0, 0, 0, 10, 0, 0, 0)

[node name="MeshInstance3D" type="MeshInstance3D" parent="StaticEnvironment/Planet"]
transform = Transform3D(2, 0, 0, 0, 2, 0, 0, 0, 2, 0, 0, 0)
mesh = SubResource("SphereMesh_gadrd")
surface_material_override/0 = ExtResource("3_5jhce")

[node name="UI" type="CanvasLayer" parent="."]

[node name="FadeOverlay" parent="UI" instance=ExtResource("1_y6ebv")]
unique_name_in_owner = true
visible = false

[node name="PauseOverlay" parent="UI" instance=ExtResource("3_8o178")]
unique_name_in_owner = true
process_mode = 2
visible = false

[node name="HUD" type="Label" parent="UI"]
unique_name_in_owner = true
offset_left = 16.0
offset_top = 16.0
offset_right = 89.0
offset_bottom = 65.0
theme = SubResource("Theme_2577t")
text = "Time: %s
Score: %s"

[node name="Player" parent="." instance=ExtResource("7_vus8m")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 10, 0)

[node name="GameManager" type="Node3D" parent="."]
script = ExtResource("5_2577t")

[node name="TimeLimit" type="Timer" parent="GameManager"]
unique_name_in_owner = true
wait_time = 60.0
one_shot = true
autostart = true

[node name="SpawnTimer" type="Timer" parent="GameManager"]
wait_time = 5.0
autostart = true

[connection signal="completed_loop" from="Player" to="GameManager" method="_on_player_completed_loop"]
[connection signal="fucked_up" from="GameManager" to="Player" method="_on_game_manager_fucked_up"]
[connection signal="points_gained" from="GameManager" to="Player" method="_on_game_manager_points_gained"]
[connection signal="timeout" from="GameManager/TimeLimit" to="GameManager" method="_on_time_limit_timeout"]
[connection signal="timeout" from="GameManager/SpawnTimer" to="GameManager" method="_on_spawn_timer_timeout"]
